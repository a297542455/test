(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-206e9b7e"],{"5d51":function(t,e,a){"use strict";a.d(e,"h",(function(){return l})),a.d(e,"e",(function(){return r})),a.d(e,"f",(function(){return i})),a.d(e,"g",(function(){return o})),a.d(e,"i",(function(){return u})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return d})),a.d(e,"d",(function(){return c})),a.d(e,"b",(function(){return f}));var n=a("b775");function l(t){return Object(n["a"])({url:"/label/getlist",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/roles/getPlist",method:"post",data:t})}function i(){return Object(n["a"])({url:"/roles/getPlist",method:"post"})}function o(t){return Object(n["a"])({url:"/roles/getInfo",method:"get",params:{id:t}})}function u(t){return Object(n["a"])({url:"/roles/save",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/roles/delete",method:"get",params:{id:t}})}function d(t,e,a){var l={val:t,field:e,value:a};return Object(n["a"])({url:"/admin/roles/change",method:"post",data:l})}function c(t){return Object(n["a"])({url:"/admin/roles/delall",method:"post",data:t})}function f(t){return Object(n["a"])({url:"/admin/roles/changeall",method:"post",data:t})}},bd43:function(t,e,a){"use strict";a.d(e,"e",(function(){return l})),a.d(e,"f",(function(){return r})),a.d(e,"g",(function(){return i})),a.d(e,"h",(function(){return o})),a.d(e,"c",(function(){return u})),a.d(e,"a",(function(){return s})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return c}));var n=a("b775");function l(t){return Object(n["a"])({url:"/rules/getlist",method:"post",data:t})}function r(){return Object(n["a"])({url:"/rules/getlist",method:"post"})}function i(t){return Object(n["a"])({url:"/rules/getInfo",method:"get",params:{id:t}})}function o(t){return Object(n["a"])({url:"/rules/save",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/rules/delete",method:"get",params:{id:t}})}function s(t,e,a){var l={val:t,field:e,value:a};return Object(n["a"])({url:"/admin/rules/change",method:"post",data:l})}function d(t){return Object(n["a"])({url:"/admin/rules/delall",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/admin/rules/changeall",method:"post",data:t})}},d808:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"100%",height:"50vh","overflow-y":"scroll"},attrs:{rules:t.rules,model:t.temp,"label-position":"left","label-width":"70px"}},[a("el-form-item",{attrs:{label:"名称",prop:"title"}},[a("el-input",{attrs:{clearable:""},model:{value:t.temp.title,callback:function(e){t.$set(t.temp,"title",e)},expression:"temp.title"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:t.temp.status,callback:function(e){t.$set(t.temp,"status",e)},expression:"temp.status"}},[a("el-radio",{attrs:{label:1}},[t._v("正常")]),a("el-radio",{attrs:{label:0}},[t._v("禁用")])],1)],1),a("el-form-item",{attrs:{label:"权限",prop:"lbdata"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"remote-method":t.remoteMethod,loading:t.loading,multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词"},model:{value:t.temp.lbdata,callback:function(e){t.$set(t.temp,"lbdata",e)},expression:"temp.lbdata"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"权限"}},[a("el-tree",{ref:"tree",attrs:{data:t.getRulesList,"default-checked-keys":t.defaultChecked,props:t.defaultProps,"default-expand-all":"","show-checkbox":"","node-key":"id"},on:{check:t.checkHandle}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("保存")])],1)],1)},l=[],r=(a("28a5"),a("7f7f"),a("bd43")),i=a("5d51"),o=a("f382"),u={name:"RolesForm",data:function(){return{btnLoading:!1,loading:!1,ruleList:[],options:[],temp:{id:"",title:"",status:1,rules:""},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加"},rules:{title:[{required:!0,message:"名称必填",trigger:"blur"}]},defaultChecked:[],defaultProps:{children:"children",label:"title"}}},computed:{getRulesList:function(){return o["a"].listToTreeMulti(this.ruleList)}},watch:{dialogFormVisible:function(){this.resetTemp()}},created:function(){this.getRules()},destroyed:function(){},methods:{remoteMethod:function(t){var e=this;""!==t?(this.loading=!0,Object(i["h"])({keyword:t}).then((function(t){var a=t.data.data;e.options=a.map((function(t){return{value:"".concat(t.id),label:"".concat(t.name)}})),e.loading=!1}))):this.options=[]},getRules:function(){var t=this;Object(r["f"])().then((function(e){t.ruleList=e.data.data}))},resetTemp:function(){this.temp={id:"",title:"",status:1,lbdata:"",rules:""}},checkHandle:function(t){var e=this.$refs.tree.getHalfCheckedKeys().join(","),a=this.$refs.tree.getCheckedKeys().join(",");e.length&&a.length?this.temp.rules=e+","+a:e.length&&0===a.length?this.temp.rules=e:0===e.length&&a.length?this.temp.rules=a:this.temp.rules=""},handleCreate:function(){var t=this;this.dialogStatus="create",this.dialogFormVisible=!0,this.currentIndex=-1,this.$refs.tree.setCheckedKeys([]),this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},handleUpdate:function(t){var e=this;this.dialogStatus="update",this.dialogFormVisible=!0;var a=this;Object(i["g"])(t).then((function(t){if(1===t.status){var n=t.data;a.temp.id=n.id,a.temp.title=n.title,a.temp.status=n.status,a.temp.rules=n.rules,e.$refs.tree.setCheckedKeys(a.temp.rules.split(",")),a.temp.lbdata=[],a.options=[],n.lbdata&&n.lbdata.map((function(t){a.options.push({value:"".concat(t.lbid),label:"".concat(t.lbname)}),a.temp.lbdata.push(t.lbid)}))}})),this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},saveData:function(){var t=this;this.btnLoading=!0,this.$refs["dataForm"].validate((function(e){if(e){var a=t,n=t.temp;n.lbRules=n.lbdata.join(","),Object(i["i"])(n).then((function(e){1===e.status?(n.id||(n.id=e.data),t.$emit("updateRow",n),a.dialogFormVisible=!1,a.$message.success(e.msg)):a.$message.error(e.msg),a.btnLoading=!1})).catch((function(e){t.btnLoading=!1}))}else t.btnLoading=!1}))}}},s=u,d=a("2877"),c=Object(d["a"])(s,n,l,!1,null,null,null);e["default"]=c.exports},f382:function(t,e,a){"use strict";a("ac6a");var n=a("ed08");function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pid",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"children",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=[];return t&&t.forEach((function(s){if(s[r]==e){null!==o&&(s=Object(n["f"])(s,o));var d=l(t,s[a],a,r,i,o);d.length&&(s[i]=d),u.push(s)}})),u}function r(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pid",l=[];return t&&t.forEach((function(i){if(i[a]==e){l.unshift(i[n]);var o=r(t,i[n],a,n);o.length&&(l=l.concat(o))}})),l}function i(t,e,a,l){return t&&t.map((function(t){t[e]===a?Object(n["f"])(t,l):i(t.children,e,a,l)})),t}var o={listToTreeMulti:l,getParentsId:r,upadteArr:i};e["a"]=o}}]);