(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ccde900","chunk-206e9b7e"],{2099:function(t,e,n){},"20bb":function(t,e,n){"use strict";var a=n("2099"),l=n.n(a);l.a},"5d51":function(t,e,n){"use strict";n.d(e,"h",(function(){return l})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return o})),n.d(e,"i",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return d})),n.d(e,"b",(function(){return h}));var a=n("b775");function l(t){return Object(a["a"])({url:"/label/getlist",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/roles/getPlist",method:"post",data:t})}function s(){return Object(a["a"])({url:"/roles/getPlist",method:"post"})}function o(t){return Object(a["a"])({url:"/roles/getInfo",method:"get",params:{id:t}})}function r(t){return Object(a["a"])({url:"/roles/save",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/roles/delete",method:"get",params:{id:t}})}function u(t,e,n){var l={val:t,field:e,value:n};return Object(a["a"])({url:"/admin/roles/change",method:"post",data:l})}function d(t){return Object(a["a"])({url:"/admin/roles/delall",method:"post",data:t})}function h(t){return Object(a["a"])({url:"/admin/roles/changeall",method:"post",data:t})}},6724:function(t,e,n){"use strict";n("8d41");var a="@@wavesContext";function l(t,e){function n(n){var a=Object.assign({},e.value),l=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),i=l.ele;if(i){i.style.position="relative",i.style.overflow="hidden";var s=i.getBoundingClientRect(),o=i.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":(o=document.createElement("span"),o.className="waves-ripple",o.style.height=o.style.width=Math.max(s.width,s.height)+"px",i.appendChild(o)),l.type){case"center":o.style.top=s.height/2-o.offsetHeight/2+"px",o.style.left=s.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(n.pageY-s.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(n.pageX-s.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=l.color,o.className="waves-ripple z-active",!1}}return t[a]?t[a].removeHandle=n:t[a]={removeHandle:n},n}var i={bind:function(t,e){t.addEventListener("click",l(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[a].removeHandle,!1),t.addEventListener("click",l(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[a].removeHandle,!1),t[a]=null,delete t[a]}},s=function(t){t.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(s)),i.install=s;e["a"]=i},"8d41":function(t,e,n){},bd43:function(t,e,n){"use strict";n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return s})),n.d(e,"h",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return d}));var a=n("b775");function l(t){return Object(a["a"])({url:"/rules/getlist",method:"post",data:t})}function i(){return Object(a["a"])({url:"/rules/getlist",method:"post"})}function s(t){return Object(a["a"])({url:"/rules/getInfo",method:"get",params:{id:t}})}function o(t){return Object(a["a"])({url:"/rules/save",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/rules/delete",method:"get",params:{id:t}})}function c(t,e,n){var l={val:t,field:e,value:n};return Object(a["a"])({url:"/admin/rules/change",method:"post",data:l})}function u(t){return Object(a["a"])({url:"/admin/rules/delall",method:"post",data:t})}function d(t){return Object(a["a"])({url:"/admin/rules/changeall",method:"post",data:t})}},d808:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-form",{ref:"dataForm",staticStyle:{width:"100%",height:"50vh","overflow-y":"scroll"},attrs:{rules:t.rules,model:t.temp,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:"名称",prop:"title"}},[n("el-input",{attrs:{clearable:""},model:{value:t.temp.title,callback:function(e){t.$set(t.temp,"title",e)},expression:"temp.title"}})],1),n("el-form-item",{attrs:{label:"状态"}},[n("el-radio-group",{model:{value:t.temp.status,callback:function(e){t.$set(t.temp,"status",e)},expression:"temp.status"}},[n("el-radio",{attrs:{label:1}},[t._v("正常")]),n("el-radio",{attrs:{label:0}},[t._v("禁用")])],1)],1),n("el-form-item",{attrs:{label:"权限",prop:"lbdata"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{"remote-method":t.remoteMethod,loading:t.loading,multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词"},model:{value:t.temp.lbdata,callback:function(e){t.$set(t.temp,"lbdata",e)},expression:"temp.lbdata"}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"权限"}},[n("el-tree",{ref:"tree",attrs:{data:t.getRulesList,"default-checked-keys":t.defaultChecked,props:t.defaultProps,"default-expand-all":"","show-checkbox":"","node-key":"id"},on:{check:t.checkHandle}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),n("el-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("保存")])],1)],1)},l=[],i=(n("28a5"),n("7f7f"),n("bd43")),s=n("5d51"),o=n("f382"),r={name:"RolesForm",data:function(){return{btnLoading:!1,loading:!1,ruleList:[],options:[],temp:{id:"",title:"",status:1,rules:""},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加"},rules:{title:[{required:!0,message:"名称必填",trigger:"blur"}]},defaultChecked:[],defaultProps:{children:"children",label:"title"}}},computed:{getRulesList:function(){return o["a"].listToTreeMulti(this.ruleList)}},watch:{dialogFormVisible:function(){this.resetTemp()}},created:function(){this.getRules()},destroyed:function(){},methods:{remoteMethod:function(t){var e=this;""!==t?(this.loading=!0,Object(s["h"])({keyword:t}).then((function(t){var n=t.data.data;e.options=n.map((function(t){return{value:"".concat(t.id),label:"".concat(t.name)}})),e.loading=!1}))):this.options=[]},getRules:function(){var t=this;Object(i["f"])().then((function(e){t.ruleList=e.data.data}))},resetTemp:function(){this.temp={id:"",title:"",status:1,lbdata:"",rules:""}},checkHandle:function(t){var e=this.$refs.tree.getHalfCheckedKeys().join(","),n=this.$refs.tree.getCheckedKeys().join(",");e.length&&n.length?this.temp.rules=e+","+n:e.length&&0===n.length?this.temp.rules=e:0===e.length&&n.length?this.temp.rules=n:this.temp.rules=""},handleCreate:function(){var t=this;this.dialogStatus="create",this.dialogFormVisible=!0,this.currentIndex=-1,this.$refs.tree.setCheckedKeys([]),this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},handleUpdate:function(t){var e=this;this.dialogStatus="update",this.dialogFormVisible=!0;var n=this;Object(s["g"])(t).then((function(t){if(1===t.status){var a=t.data;n.temp.id=a.id,n.temp.title=a.title,n.temp.status=a.status,n.temp.rules=a.rules,e.$refs.tree.setCheckedKeys(n.temp.rules.split(",")),n.temp.lbdata=[],n.options=[],a.lbdata&&a.lbdata.map((function(t){n.options.push({value:"".concat(t.lbid),label:"".concat(t.lbname)}),n.temp.lbdata.push(t.lbid)}))}})),this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},saveData:function(){var t=this;this.btnLoading=!0,this.$refs["dataForm"].validate((function(e){if(e){var n=t,a=t.temp;a.lbRules=a.lbdata.join(","),Object(s["i"])(a).then((function(e){1===e.status?(a.id||(a.id=e.data),t.$emit("updateRow",a),n.dialogFormVisible=!1,n.$message.success(e.msg)):n.$message.error(e.msg),n.btnLoading=!1})).catch((function(e){t.btnLoading=!1}))}else t.btnLoading=!1}))}}},c=r,u=n("2877"),d=Object(u["a"])(c,a,l,!1,null,null,null);e["default"]=d.exports},e075:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[t.showSearch?n("div",{staticClass:"filter-container"},[n("el-form",{staticClass:"form-inline",attrs:{inline:!0,model:t.listQuery}},[n("el-form-item",{attrs:{label:""}},[n("el-input",{attrs:{placeholder:"名称",clearable:"",size:"small"},model:{value:t.listQuery.title,callback:function(e){t.$set(t.listQuery,"title",e)},expression:"listQuery.title"}})],1),n("el-form-item",{attrs:{label:""}},[n("el-select",{attrs:{placeholder:"状态",clearable:"",size:"small"},model:{value:t.listQuery.status,callback:function(e){t.$set(t.listQuery,"status",e)},expression:"listQuery.status"}},[n("el-option",{attrs:{label:"全部",value:"-1"}}),n("el-option",{attrs:{label:"正常",value:"1"}}),n("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),n("el-form-item",[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:t.handleFilter}},[t._v("搜索")])],1),n("el-form-item",[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"warning",icon:"el-icon-refresh",size:"small"},on:{click:t.handleFilterClear}},[t._v("重置")])],1)],1)],1):t._e(),n("el-row",{staticStyle:{"margin-bottom":"10px"}},[n("el-col",{attrs:{xs:24,sm:24,lg:24}},[n("el-tooltip",{attrs:{content:"刷新",placement:"top"}},[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"warning",icon:"el-icon-refresh",circle:""},on:{click:t.handleFilterClear}})],1),n("el-tooltip",{attrs:{content:"添加",placement:"top"}},[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"success",icon:"el-icon-plus",circle:""},on:{click:t.handleCreate}})],1),n("el-tooltip",{attrs:{content:"搜索",placement:"top"}},[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-search",circle:""},on:{click:function(e){t.showSearch=!t.showSearch}}})],1),n("el-tooltip",{attrs:{content:"更多",placement:"top"}},[n("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{trigger:"click",placement:"bottom"},on:{command:t.handleCommand}},[n("el-button",{attrs:{disabled:t.buttonDisabled,type:"Info",circle:""}},[n("i",{staticClass:"el-icon-more"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"1"}},[t._v("设为正常")]),n("el-dropdown-item",{attrs:{command:"0"}},[t._v("设为禁用")])],1)],1)],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{label:"名称","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"link-type",on:{click:function(n){return t.handleUpdate(e.$index,e.row.id)}}},[t._v(t._s(e.row.title))])]}}])}),n("el-table-column",{attrs:{label:"状态",width:"110px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{class:{"el-icon-success text-green":1==e.row.status,"el-icon-error text-red":0==e.row.status},on:{click:function(n){return t.handleModifyStatus(e.$index,e.row.id,e.row.status)}}},[t._v(t._s(t._f("statusFilter")(e.row.status)))])]}}])}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"120px","class-name":"small-padding"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{attrs:{content:"编辑",placement:"top"}},[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-edit-outline",circle:""},on:{click:function(n){return t.handleUpdate(e.$index,e.row.id)}}})],1),n("el-tooltip",{attrs:{content:"删除",placement:"top"}},[n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{loading:e.row.delete,type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return t.handleDelete(e.$index,e.row.id)}}})],1)]}}])})],1),n("div",{staticClass:"pagination-container"},[n("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.psize,total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),n("rolesForm",{ref:"fromRoles",on:{updateRow:t.updateRow}})],1)},l=[],i=(n("ac6a"),n("5d51")),s=n("6724"),o=n("ed08"),r=n("d808"),c={name:"Roles",components:{rolesForm:r["default"]},directives:{waves:s["a"]},filters:{statusFilter:function(t){var e={0:"禁用",1:"正常"};return e[t]}},data:function(){return{tableKey:0,list:null,total:null,selectedRows:null,listLoading:!0,showSearch:!1,listQuery:{page:1,psize:10,status:"-1",title:""},buttonDisabled:!0,deleting:!1,pickerOptions:o["i"],currentIndex:-1}},watch:{},created:function(){this.fetchList()},methods:{fetchList:function(){var t=this;this.listLoading=!0,Object(i["e"])(this.listQuery).then((function(e){t.list=e.data.data,t.total=e.data.total,t.listLoading=!1}))},handleFilter:function(){this.listQuery.page=1,this.fetchList()},handleFilterClear:function(){this.listQuery={page:1,psize:10,status:"-1",title:""},this.fetchList()},handleSizeChange:function(t){this.listQuery.psize=t,this.fetchList()},handleCurrentChange:function(t){this.listQuery.page=t,this.fetchList()},handleModifyStatus:function(t,e,n){this.list[t]["status"]=1-n,Object(i["a"])(e,"status",1-n).then((function(t){}))},handleSelectionChange:function(t){t.length>0?this.buttonDisabled=!1:this.buttonDisabled=!0,this.selectedRows=t},handleCreate:function(){this.$refs.fromRoles.handleCreate()},handleUpdate:function(t,e){this.currentIndex=t,this.$refs.fromRoles.handleUpdate(e)},updateRow:function(t){this.fetchList(),this.currentIndex=-1},handleDelete:function(t,e){var n=this,a=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$set(a.list[t],"delete",!0),Object(i["c"])(e).then((function(e){1===e.status?(a.list.splice(t,1),a.total=a.total-1,a.$notify.success(e.msg)):a.$notify.error(e.msg),a.$set(a.list[t],"delete",!1)})).catch((function(e){a.$set(a.list[t],"delete",!1)}))})).catch((function(){n.$message({type:"info",message:"已取消删除"})}))},handleDeleteAll:function(){var t=this,e=this;this.selectedRows.length>0?this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.deleting=!0;var t=Object(o["d"])(e.selectedRows,"id"),n=t.join(",");Object(i["d"])({ids:n}).then((function(n){if(1===n.status){var a=[];e.list.forEach((function(e,n,l){t.indexOf(e.id)>-1&&a.push(n)}));for(var l=a.length-1;l>=0;l--)e.list.splice(a[l],1);e.total=e.total-a.length,e.$message.success(n.msg)}else e.$message.error(n.msg);e.deleting=!1})).catch((function(t){e.deleting=!1}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})})):e.$message.error("请选择要删除的数据")},handleCommand:function(t){var e=this;if(this.selectedRows.length>0){var n=Object(o["d"])(this.selectedRows,"id"),a=n.join(",");Object(i["b"])({val:a,field:"status",value:t}).then((function(a){1===a.status?(e.list.forEach((function(a,l,i){n.indexOf(a.id)>-1&&(e.list[l]["status"]=t)})),e.$message.success(a.msg)):e.$message.error(a.msg)})).catch((function(t){}))}else e.$message.error("请选择要操作的数据")}}},u=c,d=(n("20bb"),n("2877")),h=Object(d["a"])(u,a,l,!1,null,null,null);e["default"]=h.exports},f382:function(t,e,n){"use strict";n("ac6a");var a=n("ed08");function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pid",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"children",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=[];return t&&t.forEach((function(c){if(c[i]==e){null!==o&&(c=Object(a["f"])(c,o));var u=l(t,c[n],n,i,s,o);u.length&&(c[s]=u),r.push(c)}})),r}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pid",l=[];return t&&t.forEach((function(s){if(s[n]==e){l.unshift(s[a]);var o=i(t,s[a],n,a);o.length&&(l=l.concat(o))}})),l}function s(t,e,n,l){return t&&t.map((function(t){t[e]===n?Object(a["f"])(t,l):s(t.children,e,n,l)})),t}var o={listToTreeMulti:l,getParentsId:i,upadteArr:s};e["a"]=o}}]);